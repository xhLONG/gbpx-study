// ==UserScript==
// @name         GD干部学习
// @namespace    http://tampermonkey.net/
// @version      1.5
// @description  study now!
// @author       xhlong
// @updateURL
// @match        https://gbpx.gd.gov.cn/*
// @match        https://*.shawcoder.xyz/*
// @grant        unsafeWindow
// @grant        GM_openInTab
// @run-at       document-start
// ==/UserScript==
(()=>{var u;unsafeWindow.alert=function(){return!1};window.alert=function(){return!1};Window.prototype.alert=function(){return!1};if(window.location.pathname=="/gdceportal/study/studyCenter.aspx"){let e="#aspnetForm > div:nth-child(13) > div.imgAndMessage";l(e,function(){document.querySelector(e).remove()});let t="#aspnetForm > div.signup_header2";l(t,function(){document.querySelector(t).remove()})}if(window.location.pathname=="/gdceportal/Study/LearningCourse.aspx"){let e=0;l("#lblTotal",function(){e=document.querySelector("#lblTotal").textContent}),console.log(`\u68C0\u6D4B\u5230\u8BFE\u7A0B\u5217\u8868\uFF0C\u5171${e}\u9879`),c="#gvList_ctl02_HyperLink2",l(c,function(){setTimeout(m(c),3e3)}),l("#gvList > tbody > tr:nth-child(2)",function(){let t=parseFloat(document.querySelector("#gvList > tbody > tr:nth-child(2) > td:nth-child(5) > div > div:nth-child(2)").textContent)*.01,o=parseFloat(document.querySelector("#gvList > tbody > tr:nth-child(2) > td:nth-child(2)").textContent),n=document.querySelector(c).textContent,i=parseInt(o/60*45*60*60*(1-t))+1,a=1800;console.log(`\u5F53\u524D\u64AD\u653E\u8BFE\u7A0B\uFF1A${n}\uFF0C\u8FDB\u5EA6\uFF1A${t*100}%\uFF0C\u5269\u4F59\uFF1A${i}s`);let r=a,s=setInterval(function(){document.querySelector("#gvList_ctl02_HyperLink1").innerText="\u23F0 "+r+"s\u540E\u5237\u65B0",r+=-1,r<=0&&(u.close(),location.reload(!0),clearInterval(s))},1e3)})}var c;window.location.pathname=="/gdceportal/Study/CourseDetail.aspx"&&(d="#btnStudy",l(d,function(){document.querySelector(d).click()}));var d;window.location.host=="wcs1.shawcoder.xyz"&window.location.pathname=="/gdcecw/play_pc/playmp4_pc.html"&&(window.onload=function(){console.log("\u81EA\u52A8\u64AD\u653E\u89C6\u9891");let e=!1,t=20,o=0;for(;!e&&o<t;){y(200),o=o+1;let n=document.querySelector("video");n&&(n.muted=!0,e=!0,n.addEventListener("pause",()=>{console.log("\u89C6\u9891\u5DF2\u7ECF\u6682\u505C\uFF0C\u89E6\u53D1\u7EE7\u7EED\u64AD\u653E"),n.ended||n.play().catch(i=>{console.log("\u89C6\u9891\u64AD\u653E\u5931\u8D25\uFF0C\u65E0\u6CD5\u7EE7\u7EED\u64AD\u653E\uFF1A",i)})}))}l("#my-video > button",function(){setTimeout(function(){document.querySelector("#my-video_html5_api").play()},3e3)})});function m(e){let t=document.querySelector(e);document.querySelector("#gvList > tbody > tr:nth-child(2)").style.backgroundColor="yellow",document.querySelector("#gvList > tbody > tr:nth-child(2)").style.color="red";let o="https://gbpx.gd.gov.cn/gdceportal/Study/"+t.href.slice(14,67);u=GM_openInTab(o,"insert")}function y(e){return new Promise(t=>setTimeout(t,e))}function l(e,t){let o=!1;var i=setInterval(()=>{document.querySelector(e)&&(o=!0,t()),o&&clearInterval(i)},100)}})();
